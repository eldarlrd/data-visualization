import{c as En,s as ln,h as kn,a as Pn}from"./index-BG6vf5fz.js";import{e as An,a as $n,f as Rn,u as J}from"./useApi-CBYkAbkT.js";import{m as On}from"./min-D1slsF82.js";import{m as Cn}from"./max-DBeXZoyG.js";import{c as Ln,r as In}from"./ramp-CCIUSDs0.js";class w{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const i=this._partials;let e=0;for(let r=0;r<this._n&&r<32;r++){const s=i[r],u=t+s,c=Math.abs(t)<Math.abs(s)?t-(u-s):s-(u-t);c&&(i[e++]=c),t=u}return i[e]=t,this._n=e+1,this}valueOf(){const t=this._partials;let i=this._n,e,r,s,u=0;if(i>0){for(u=t[--i];i>0&&(e=u,r=t[--i],u=e+r,s=r-(u-e),!s););i>0&&(s<0&&t[i-1]<0||s>0&&t[i-1]>0)&&(r=s*2,e=u+r,r==e-u&&(u=e))}return u}}var Tn=Math.PI,xn=Tn*2,Fn=Math.abs,U=Math.sqrt;function m(){}function O(n,t){n&&Q.hasOwnProperty(n.type)&&Q[n.type](n,t)}var j={Feature:function(n,t){O(n.geometry,t)},FeatureCollection:function(n,t){for(var i=n.features,e=-1,r=i.length;++e<r;)O(i[e].geometry,t)}},Q={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var i=n.coordinates,e=-1,r=i.length;++e<r;)n=i[e],t.point(n[0],n[1],n[2])},LineString:function(n,t){V(n.coordinates,t,0)},MultiLineString:function(n,t){for(var i=n.coordinates,e=-1,r=i.length;++e<r;)V(i[e],t,0)},Polygon:function(n,t){nn(n.coordinates,t)},MultiPolygon:function(n,t){for(var i=n.coordinates,e=-1,r=i.length;++e<r;)nn(i[e],t)},GeometryCollection:function(n,t){for(var i=n.geometries,e=-1,r=i.length;++e<r;)O(i[e],t)}};function V(n,t,i){var e=-1,r=n.length-i,s;for(t.lineStart();++e<r;)s=n[e],t.point(s[0],s[1],s[2]);t.lineEnd()}function nn(n,t){var i=-1,e=n.length;for(t.polygonStart();++i<e;)V(n[i],t,1);t.polygonEnd()}function N(n,t){n&&j.hasOwnProperty(n.type)?j[n.type](n,t):O(n,t)}const Hn=n=>n;var Y=new w,W=new w,fn,hn,K,z,v={point:m,lineStart:m,lineEnd:m,polygonStart:function(){v.lineStart=Yn,v.lineEnd=Vn},polygonEnd:function(){v.lineStart=v.lineEnd=v.point=m,Y.add(Fn(W)),W=new w},result:function(){var n=Y/2;return Y=new w,n}};function Yn(){v.point=Gn}function Gn(n,t){v.point=dn,fn=K=n,hn=z=t}function dn(n,t){W.add(z*n-K*t),K=n,z=t}function Vn(){dn(fn,hn)}var M=1/0,C=M,$=-M,L=$,tn={point:Wn,lineStart:m,lineEnd:m,polygonStart:m,polygonEnd:m,result:function(){var n=[[M,C],[$,L]];return $=L=-(C=M=1/0),n}};function Wn(n,t){n<M&&(M=n),n>$&&($=n),t<C&&(C=t),t>L&&(L=t)}var Z=0,D=0,E=0,I=0,T=0,_=0,X=0,q=0,k=0,pn,gn,y,b,g={point:S,lineStart:en,lineEnd:rn,polygonStart:function(){g.lineStart=Zn,g.lineEnd=Dn},polygonEnd:function(){g.point=S,g.lineStart=en,g.lineEnd=rn},result:function(){var n=k?[X/k,q/k]:_?[I/_,T/_]:E?[Z/E,D/E]:[NaN,NaN];return Z=D=E=I=T=_=X=q=k=0,n}};function S(n,t){Z+=n,D+=t,++E}function en(){g.point=Kn}function Kn(n,t){g.point=zn,S(y=n,b=t)}function zn(n,t){var i=n-y,e=t-b,r=U(i*i+e*e);I+=r*(y+n)/2,T+=r*(b+t)/2,_+=r,S(y=n,b=t)}function rn(){g.point=S}function Zn(){g.point=Xn}function Dn(){mn(pn,gn)}function Xn(n,t){g.point=mn,S(pn=y=n,gn=b=t)}function mn(n,t){var i=n-y,e=t-b,r=U(i*i+e*e);I+=r*(y+n)/2,T+=r*(b+t)/2,_+=r,r=b*n-y*t,X+=r*(y+n),q+=r*(b+t),k+=r*3,S(y=n,b=t)}function yn(n){this._context=n}yn.prototype={_radius:4.5,pointRadius:function(n){return this._radius=n,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(n,t){switch(this._point){case 0:{this._context.moveTo(n,t),this._point=1;break}case 1:{this._context.lineTo(n,t);break}default:{this._context.moveTo(n+this._radius,t),this._context.arc(n,t,this._radius,0,xn);break}}},result:m};var B=new w,G,bn,vn,P,A,R={point:m,lineStart:function(){R.point=qn},lineEnd:function(){G&&Sn(bn,vn),R.point=m},polygonStart:function(){G=!0},polygonEnd:function(){G=null},result:function(){var n=+B;return B=new w,n}};function qn(n,t){R.point=Sn,bn=P=n,vn=A=t}function Sn(n,t){P-=n,A-=t,B.add(U(P*P+A*A)),P=n,A=t}let an,x,on,sn;class un{constructor(t){this._append=t==null?_n:Bn(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,i){switch(this._point){case 0:{this._append`M${t},${i}`,this._point=1;break}case 1:{this._append`L${t},${i}`;break}default:{if(this._append`M${t},${i}`,this._radius!==on||this._append!==x){const e=this._radius,r=this._;this._="",this._append`m0,${e}a${e},${e} 0 1,1 0,${-2*e}a${e},${e} 0 1,1 0,${2*e}z`,on=e,x=this._append,sn=this._,this._=r}this._+=sn;break}}}result(){const t=this._;return this._="",t.length?t:null}}function _n(n){let t=1;this._+=n[0];for(const i=n.length;t<i;++t)this._+=arguments[t]+n[t]}function Bn(n){const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);if(t>15)return _n;if(t!==an){const i=10**t;an=t,x=function(r){let s=1;this._+=r[0];for(const u=r.length;s<u;++s)this._+=Math.round(arguments[s]*i)/i+r[s]}}return x}function Un(n,t){let i=3,e=4.5,r,s;function u(c){return c&&(typeof e=="function"&&s.pointRadius(+e.apply(this,arguments)),N(c,r(s))),s.result()}return u.area=function(c){return N(c,r(v)),v.result()},u.measure=function(c){return N(c,r(R)),R.result()},u.bounds=function(c){return N(c,r(tn)),tn.result()},u.centroid=function(c){return N(c,r(g)),g.result()},u.projection=function(c){return arguments.length?(r=c==null?(n=null,Hn):(n=c).stream,u):n},u.context=function(c){return arguments.length?(s=c==null?(t=null,new un(i)):new yn(t=c),typeof e!="function"&&s.pointRadius(e),u):t},u.pointRadius=function(c){return arguments.length?(e=typeof c=="function"?c:(s.pointRadius(+c),+c),u):e},u.digits=function(c){if(!arguments.length)return i;if(c==null)i=null;else{const d=Math.floor(c);if(!(d>=0))throw new RangeError(`invalid digits: ${c}`);i=d}return t===null&&(s=new un(i)),u},u.projection(n).digits(i).context(t)}function wn(){var n=0,t=1,i=1,e=[.5],r=[0,1],s;function u(d){return d!=null&&d<=d?r[Rn(e,d,0,i)]:s}function c(){var d=-1;for(e=new Array(i);++d<i;)e[d]=((d+1)*t-(d-i)*n)/(i+1);return u}return u.domain=function(d){return arguments.length?([n,t]=d,n=+n,t=+t,c()):[n,t]},u.range=function(d){return arguments.length?(i=(r=Array.from(d)).length-1,c()):r.slice()},u.invertExtent=function(d){var l=r.indexOf(d);return l<0?[NaN,NaN]:l<1?[n,e[0]]:l>=i?[e[i-1],t]:[e[l-1],e[l]]},u.unknown=function(d){return arguments.length&&(s=d),u},u.thresholds=function(){return e.slice()},u.copy=function(){return wn().domain([n,t]).range(r).unknown(s)},An.apply($n(u),arguments)}var Mn=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Ln);In(Mn);function Jn(n){return n}function jn(n){if(n==null)return Jn;var t,i,e=n.scale[0],r=n.scale[1],s=n.translate[0],u=n.translate[1];return function(c,d){d||(t=i=0);var l=2,o=c.length,a=new Array(o);for(a[0]=(t+=c[0])*e+s,a[1]=(i+=c[1])*r+u;l<o;)a[l]=c[l],++l;return a}}function Qn(n,t){for(var i,e=n.length,r=e-t;r<--e;)i=n[r],n[r++]=n[e],n[e]=i}function nt(n,t){return typeof t=="string"&&(t=n.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(i){return cn(n,i)})}:cn(n,t)}function cn(n,t){var i=t.id,e=t.bbox,r=t.properties==null?{}:t.properties,s=Nn(n,t);return i==null&&e==null?{type:"Feature",properties:r,geometry:s}:e==null?{type:"Feature",id:i,properties:r,geometry:s}:{type:"Feature",id:i,bbox:e,properties:r,geometry:s}}function Nn(n,t){var i=jn(n.transform),e=n.arcs;function r(o,a){a.length&&a.pop();for(var f=e[o<0?~o:o],h=0,p=f.length;h<p;++h)a.push(i(f[h],h));o<0&&Qn(a,p)}function s(o){return i(o)}function u(o){for(var a=[],f=0,h=o.length;f<h;++f)r(o[f],a);return a.length<2&&a.push(a[0]),a}function c(o){for(var a=u(o);a.length<4;)a.push(a[0]);return a}function d(o){return o.map(c)}function l(o){var a=o.type,f;switch(a){case"GeometryCollection":return{type:a,geometries:o.geometries.map(l)};case"Point":f=s(o.coordinates);break;case"MultiPoint":f=o.coordinates.map(s);break;case"LineString":f=u(o.arcs);break;case"MultiLineString":f=o.arcs.map(u);break;case"Polygon":f=d(o.arcs);break;case"MultiPolygon":f=o.arcs.map(d);break;default:return null}return{type:a,coordinates:f}}return l(t)}function tt(n,t){var i={},e={},r={},s=[],u=-1;t.forEach(function(l,o){var a=n.arcs[l<0?~l:l],f;a.length<3&&!a[1][0]&&!a[1][1]&&(f=t[++u],t[u]=l,t[o]=f)}),t.forEach(function(l){var o=c(l),a=o[0],f=o[1],h,p;if(h=r[a])if(delete r[h.end],h.push(l),h.end=f,p=e[f]){delete e[p.start];var F=p===h?h:h.concat(p);e[F.start=h.start]=r[F.end=p.end]=F}else e[h.start]=r[h.end]=h;else if(h=e[f])if(delete e[h.start],h.unshift(l),h.start=a,p=r[a]){delete r[p.end];var H=p===h?h:p.concat(h);e[H.start=p.start]=r[H.end=h.end]=H}else e[h.start]=r[h.end]=h;else h=[l],e[h.start=a]=r[h.end=f]=h});function c(l){var o=n.arcs[l<0?~l:l],a=o[0],f;return n.transform?(f=[0,0],o.forEach(function(h){f[0]+=h[0],f[1]+=h[1]})):f=o[o.length-1],l<0?[f,a]:[a,f]}function d(l,o){for(var a in l){var f=l[a];delete o[f.start],delete f.start,delete f.end,f.forEach(function(h){i[h<0?~h:h]=1}),s.push(f)}}return d(r,e),d(e,r),t.forEach(function(l){i[l<0?~l:l]||s.push([l])}),s}function et(n){return Nn(n,rt.apply(this,arguments))}function rt(n,t,i){var e,r,s;if(arguments.length>1)e=it(n,t,i);else for(r=0,e=new Array(s=n.arcs.length);r<s;++r)e[r]=r;return{type:"MultiLineString",arcs:tt(n,e)}}function it(n,t,i){var e=[],r=[],s;function u(a){var f=a<0?~a:a;(r[f]||(r[f]=[])).push({i:a,g:s})}function c(a){a.forEach(u)}function d(a){a.forEach(c)}function l(a){a.forEach(d)}function o(a){switch(s=a,a.type){case"GeometryCollection":a.geometries.forEach(o);break;case"LineString":c(a.arcs);break;case"MultiLineString":case"Polygon":d(a.arcs);break;case"MultiPolygon":l(a.arcs);break}}return o(t),r.forEach(i==null?function(a){e.push(a[0].i)}:function(a){i(a[0].g,a[a.length-1].g)&&e.push(a[0].i)}),e}const at={AL:"Alabama",AK:"Alaska",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",FL:"Florida",GA:"Georgia",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PA:"Pennsylvania",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"},ot=(n,t,i)=>{const r="black",s=n.clientY,{bachelorsOrHigher:u=0,area_name:c="",state:d=""}=i.get(Number(t.id))??{};Pn({e:n,posY:s,width:13.5,fillColor:r}),ln("#tooltip").html(`
      <strong>
        ${c.toString()}
        <br>
        ${at[d]}
      </strong>
      – ${u.toString()}%
    `)},st=(n,t)=>{const i=On(t.map(o=>o.bachelorsOrHigher))??0,e=Cn(t.map(o=>o.bachelorsOrHigher))??0,r=wn([i,e],Mn[9]),s=nt(n,n.objects.counties),u=new Map(t.map(o=>[o.fips,{fips:o.fips,bachelorsOrHigher:o.bachelorsOrHigher,area_name:o.area_name,state:o.state}])),c="features"in s?s.features:[],d=Un(),l=ln("#choropleth-map").append("svg").attr("viewBox","0 0 900 600");l.append("g").selectAll("path").data(c).enter().append("path").attr("fill",o=>{var a;return r(Number((a=u.get(Number(o.id)))==null?void 0:a.bachelorsOrHigher))}).attr("d",d).on("mouseover",(o,a)=>{ot(o,a,u)}).on("mouseout",(o,a)=>{var f;kn(o,r(Number((f=u.get(Number(a.id)))==null?void 0:f.bachelorsOrHigher)))}),l.append("path").datum(et(n,n.objects.states,(o,a)=>o!==a)).attr("fill","none").attr("stroke","#f8f9fa").attr("stroke-width",2).attr("stroke-linejoin","round").attr("d",d)},dt=()=>(Promise.all([J("topology"),J("education")]).then(([n,t])=>{st(n,t)}).catch(n=>{n instanceof Error&&console.error(n)}),En(3,"choropleth-map"));export{dt as ChoroplethMap};
