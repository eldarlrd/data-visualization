import{c as k,s as B,h as T,d as S,a as R}from"./index-CWHYqw6R.js";import{u as C}from"./useApi-C3ZJ7Fz9.js";import{o as O}from"./ordinal-BUAAcmFa.js";import{c as $}from"./colors-Cc3OSVma.js";function q(t){var e=0,r=t.children,i=r&&r.length;if(!i)e=1;else for(;--i>=0;)e+=r[i].value;t.value=e}function I(){return this.eachAfter(q)}function V(t,e){let r=-1;for(const i of this)t.call(e,i,++r,this);return this}function j(t,e){for(var r=this,i=[r],a,s,u=-1;r=i.pop();)if(t.call(e,r,++u,this),a=r.children)for(s=a.length-1;s>=0;--s)i.push(a[s]);return this}function z(t,e){for(var r=this,i=[r],a=[],s,u,h,o=-1;r=i.pop();)if(a.push(r),s=r.children)for(u=0,h=s.length;u<h;++u)i.push(s[u]);for(;r=a.pop();)t.call(e,r,++o,this);return this}function D(t,e){let r=-1;for(const i of this)if(t.call(e,i,++r,this))return i}function E(t){return this.eachAfter(function(e){for(var r=+t(e.data)||0,i=e.children,a=i&&i.length;--a>=0;)r+=i[a].value;e.value=r})}function H(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function Y(t){for(var e=this,r=U(e,t),i=[e];e!==r;)e=e.parent,i.push(e);for(var a=i.length;t!==r;)i.splice(a,0,t),t=t.parent;return i}function U(t,e){if(t===e)return t;var r=t.ancestors(),i=e.ancestors(),a=null;for(t=r.pop(),e=i.pop();t===e;)a=t,t=r.pop(),e=i.pop();return a}function Z(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function F(){return Array.from(this)}function G(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function J(){var t=this,e=[];return t.each(function(r){r!==t&&e.push({source:r.parent,target:r})}),e}function*K(){var t=this,e,r=[t],i,a,s;do for(e=r.reverse(),r=[];t=e.pop();)if(yield t,i=t.children)for(a=0,s=i.length;a<s;++a)r.push(i[a]);while(r.length)}function L(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=W)):e===void 0&&(e=Q);for(var r=new b(t),i,a=[r],s,u,h,o;i=a.pop();)if((u=e(i.data))&&(o=(u=Array.from(u)).length))for(i.children=u,h=o-1;h>=0;--h)a.push(s=u[h]=new b(u[h])),s.parent=i,s.depth=i.depth+1;return r.eachBefore(tt)}function P(){return L(this).eachBefore(X)}function Q(t){return t.children}function W(t){return Array.isArray(t)?t[1]:null}function X(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function tt(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function b(t){this.data=t,this.depth=this.height=0,this.parent=null}b.prototype=L.prototype={constructor:b,count:I,each:V,eachAfter:z,eachBefore:j,find:D,sum:E,sort:H,path:Y,ancestors:Z,descendants:F,leaves:G,links:J,copy:P,[Symbol.iterator]:K};function et(t){if(typeof t!="function")throw new Error;return t}function x(){return 0}function _(t){return function(){return t}}function nt(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function rt(t,e,r,i,a){for(var s=t.children,u,h=-1,o=s.length,l=t.value&&(i-e)/t.value;++h<o;)u=s[h],u.y0=r,u.y1=a,u.x0=e,u.x1=e+=u.value*l}function it(t,e,r,i,a){for(var s=t.children,u,h=-1,o=s.length,l=t.value&&(a-r)/t.value;++h<o;)u=s[h],u.x0=e,u.x1=i,u.y0=r,u.y1=r+=u.value*l}var at=(1+Math.sqrt(5))/2;function ot(t,e,r,i,a,s){for(var u=[],h=e.children,o,l,c=0,v=0,n=h.length,d,p,g=e.value,f,m,w,M,A,N,y;c<n;){d=a-r,p=s-i;do f=h[v++].value;while(!f&&v<n);for(m=w=f,N=Math.max(p/d,d/p)/(g*t),y=f*f*N,A=Math.max(w/y,y/m);v<n;++v){if(f+=l=h[v].value,l<m&&(m=l),l>w&&(w=l),y=f*f*N,M=Math.max(w/y,y/m),M>A){f-=l;break}A=M}u.push(o={value:f,dice:d<p,children:h.slice(c,v)}),o.dice?rt(o,r,i,a,g?i+=p*f/g:s):it(o,r,i,g?r+=d*f/g:a,s),g-=f,c=v}return u}const ut=function t(e){function r(i,a,s,u,h){ot(e,i,a,s,u,h)}return r.ratio=function(i){return t((i=+i)>1?i:1)},r}(at);function st(){var t=ut,e=!1,r=1,i=1,a=[0],s=x,u=x,h=x,o=x,l=x;function c(n){return n.x0=n.y0=0,n.x1=r,n.y1=i,n.eachBefore(v),a=[0],e&&n.eachBefore(nt),n}function v(n){var d=a[n.depth],p=n.x0+d,g=n.y0+d,f=n.x1-d,m=n.y1-d;f<p&&(p=f=(p+f)/2),m<g&&(g=m=(g+m)/2),n.x0=p,n.y0=g,n.x1=f,n.y1=m,n.children&&(d=a[n.depth+1]=s(n)/2,p+=l(n)-d,g+=u(n)-d,f-=h(n)-d,m-=o(n)-d,f<p&&(p=f=(p+f)/2),m<g&&(g=m=(g+m)/2),t(n,p,g,f,m))}return c.round=function(n){return arguments.length?(e=!!n,c):e},c.size=function(n){return arguments.length?(r=+n[0],i=+n[1],c):[r,i]},c.tile=function(n){return arguments.length?(t=et(n),c):t},c.padding=function(n){return arguments.length?c.paddingInner(n).paddingOuter(n):c.paddingInner()},c.paddingInner=function(n){return arguments.length?(s=typeof n=="function"?n:_(+n),c):s},c.paddingOuter=function(n){return arguments.length?c.paddingTop(n).paddingRight(n).paddingBottom(n).paddingLeft(n):c.paddingTop()},c.paddingTop=function(n){return arguments.length?(u=typeof n=="function"?n:_(+n),c):u},c.paddingRight=function(n){return arguments.length?(h=typeof n=="function"?n:_(+n),c):h},c.paddingBottom=function(n){return arguments.length?(o=typeof n=="function"?n:_(+n),c):o},c.paddingLeft=function(n){return arguments.length?(l=typeof n=="function"?n:_(+n),c):l},c}const ct=$("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),ht=(t,e)=>{var a;const i=t.clientY;R({e:t,posY:i,width:13.5}),B("#tooltip").html(`
      <strong class='fw-medium'>
        ${e.data.name}
        <br>
        ${((a=e.parent)==null?void 0:a.data.name)??"Unknown"}
      </strong>
      - $${(+e.data.value).toLocaleString()}
    `)},lt=(t,e,r)=>{var n,d;const i=t.text().split(/\s+/).reverse();let a,s=[],u=0;const h=1.1,o=+t.attr("x"),l=+t.attr("y");let c=t.text(null).append("tspan").attr("x",o).attr("y",l);for(;a=i.pop();)s.push(a),c.text(s.join(" ")),(((n=c.node())==null?void 0:n.getComputedTextLength())??0)>e&&s.length>1&&(s.pop(),c.text(s.join(" ")),s=[a],c=t.append("tspan").attr("x",o).attr("y",l+ ++u*h*10).text(a));const v=((d=t.node())==null?void 0:d.getBBox().height)??0;v>r&&t.attr("y",r/2-v/2)},ft=t=>{const i=B("#diagram").attr("width",720).attr("height",475),a=L(t).sum(o=>Number(o.value)).sort((o,l)=>Number(l.value)-Number(o.value));st().size([720,475]).paddingInner(1)(a);const u=O(ct),h=i.selectAll("g").data(a.leaves()).enter().append("g").attr("transform",o=>`translate(${o.x0.toString()},${o.y0.toString()})`);h.append("rect").attr("width",o=>o.x1-o.x0).attr("height",o=>o.y1-o.y0).attr("fill",o=>{var l;return u(((l=o.parent)==null?void 0:l.data.name)??"")}).on("mouseover",(o,l)=>{ht(o,l)}).on("mouseout",function(o){const l=B(this).style("fill");T(o,l)}),h.append("text").attr("x",5).attr("y",15).text(o=>o.data.name).attr("fill",S.COLORS.white).style("font-size","10px").classed("fw-medium",!0).classed("pe-none",!0).each(function(o){const l=B(this);lt(l,o.x1-o.x0,o.y1-o.y0)})},vt=()=>(C("movies").then(t=>{ft(t)}).catch(t=>{t instanceof Error&&console.error(t)}),k(4,"diagram"));export{vt as TreemapDiagram};
