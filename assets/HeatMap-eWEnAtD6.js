import{c as M,s as v,h as x,a as A}from"./index-CWHYqw6R.js";import{i as N,u as $}from"./useApi-C3ZJ7Fz9.js";import{b as g}from"./band-Bbu3waYT.js";import{c as F,i as w,d as O,e as k,a as J,b as V}from"./linear-Do45k01q.js";import{c as E}from"./colors-Cc3OSVma.js";import{r as R}from"./ramp-CEbJrTy8.js";import"./ordinal-BUAAcmFa.js";function T(t,r){let n,e;if(r===void 0)for(const o of t)o!=null&&(n===void 0?o>=o&&(n=e=o):(n>o&&(n=o),e<o&&(e=o)));else{let o=-1;for(let i of t)(i=r(i,++o,t))!=null&&(n===void 0?i>=i&&(n=e=i):(n>i&&(n=i),e<i&&(e=i)))}return[n,e]}function C(){var t=0,r=1,n,e,o,i,s=w,l=!1,d;function f(a){return a==null||isNaN(a=+a)?d:s(o===0?.5:(a=(i(a)-n)*o,l?Math.max(0,Math.min(1,a)):a))}f.domain=function(a){return arguments.length?([t,r]=a,n=i(t=+t),e=i(r=+r),o=n===e?0:1/(e-n),f):[t,r]},f.clamp=function(a){return arguments.length?(l=!!a,f):l},f.interpolator=function(a){return arguments.length?(s=a,f):s};function m(a){return function(b){var u,p;return arguments.length?([u,p]=b,s=a(u,p),f):[s(0),s(1)]}}return f.range=m(O),f.rangeRound=m(k),f.unknown=function(a){return arguments.length?(d=a,f):d},function(a){return i=a,n=a(t),e=a(r),o=n===e?0:1/(e-n),f}}function L(t,r){return r.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function S(){var t=F(C()(w));return t.copy=function(){return L(t,S())},N.apply(t,arguments)}var U=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(E);const Y=R(U),y=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],B=["January","February","March","April","May","June","July","August","September","October","November","December"],H=(t,r,n)=>{const o=t.clientY,i=r.variance>0?`+${r.variance.toFixed(2)}`:r.variance.toFixed(2);A({e:t,posY:o,width:10.5}),v("#tooltip").html(`
      <strong class='fw-medium'>
        ${r.year.toString()} ${B[r.month-1]} 
      </strong>
      <br>
      ${(n+r.variance).toFixed(2)} °C | ${i} °C
    `)},D=t=>{const{baseTemperature:r,monthlyVariance:n}=t,e={top:0,right:60,bottom:20,left:80},o=800-e.left-e.right,i=400-e.top-e.bottom,s=v("#heat-map").attr("width",o+e.left+e.right).attr("height",i+e.top+e.bottom).append("g").attr("transform",`translate(${e.left.toString()}, ${e.top.toString()})`),l=[...new Set(n.map(c=>c.year.toString()))],d=g().range([0,o]).domain(l),f=g().range([0,i]).domain(y),m=T(n,c=>r+c.variance),a=m[0]??0,b=m[1]??0,u=S().interpolator(Y).domain([b,a]);s.selectAll().data(n).enter().append("rect").attr("x",c=>d(c.year.toString())??0).attr("y",c=>f(y[c.month-1])??0).attr("width",d.bandwidth()).attr("height",f.bandwidth()).style("fill",c=>u(r+c.variance)).on("mouseover",(c,h)=>{H(c,h,r)}).on("mouseout",(c,h)=>{x(c,u(r+h.variance),!0)});const p=l.filter(c=>+c%10===0);s.append("g").attr("transform",`translate(0, ${i.toString()})`).call(J(d).tickValues(p)),s.append("g").call(V(f))},K=()=>($("temperature").then(t=>{D(t)}).catch(t=>{t instanceof Error&&console.error(t)}),M(2,"heat-map"));export{K as HeatMap};
