import{c as Et,s as ut,h as Nt,d as kt,a as $t}from"./index-CWHYqw6R.js";import{a as At,u as J}from"./useApi-C3ZJ7Fz9.js";import{m as Pt}from"./min-D1slsF82.js";import{m as Rt}from"./max-DBeXZoyG.js";import{c as Ot,f as Ct,l as Lt,a as xt}from"./linear-Do45k01q.js";import{c as It}from"./colors-Cc3OSVma.js";import{r as Tt}from"./ramp-CEbJrTy8.js";class _{constructor(){this._partials=new Float64Array(32),this._n=0}add(n){const i=this._partials;let e=0;for(let r=0;r<this._n&&r<32;r++){const s=i[r],c=n+s,u=Math.abs(n)<Math.abs(s)?n-(c-s):s-(c-n);u&&(i[e++]=u),n=c}return i[e]=n,this._n=e+1,this}valueOf(){const n=this._partials;let i=this._n,e,r,s,c=0;if(i>0){for(c=n[--i];i>0&&(e=c,r=n[--i],c=e+r,s=r-(c-e),!s););i>0&&(s<0&&n[i-1]<0||s>0&&n[i-1]>0)&&(r=s*2,e=c+r,r==e-c&&(c=e))}return c}}var Ft=Math.PI,Ht=Ft*2,Yt=Math.abs,U=Math.sqrt;function m(){}function O(t,n){t&&Q.hasOwnProperty(t.type)&&Q[t.type](t,n)}var j={Feature:function(t,n){O(t.geometry,n)},FeatureCollection:function(t,n){for(var i=t.features,e=-1,r=i.length;++e<r;)O(i[e].geometry,n)}},Q={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var i=t.coordinates,e=-1,r=i.length;++e<r;)t=i[e],n.point(t[0],t[1],t[2])},LineString:function(t,n){W(t.coordinates,n,0)},MultiLineString:function(t,n){for(var i=t.coordinates,e=-1,r=i.length;++e<r;)W(i[e],n,0)},Polygon:function(t,n){tt(t.coordinates,n)},MultiPolygon:function(t,n){for(var i=t.coordinates,e=-1,r=i.length;++e<r;)tt(i[e],n)},GeometryCollection:function(t,n){for(var i=t.geometries,e=-1,r=i.length;++e<r;)O(i[e],n)}};function W(t,n,i){var e=-1,r=t.length-i,s;for(n.lineStart();++e<r;)s=t[e],n.point(s[0],s[1],s[2]);n.lineEnd()}function tt(t,n){var i=-1,e=t.length;for(n.polygonStart();++i<e;)W(t[i],n,1);n.polygonEnd()}function E(t,n){t&&j.hasOwnProperty(t.type)?j[t.type](t,n):O(t,n)}const Vt=t=>t;var Y=new _,G=new _,lt,ft,z,K,b={point:m,lineStart:m,lineEnd:m,polygonStart:function(){b.lineStart=Wt,b.lineEnd=zt},polygonEnd:function(){b.lineStart=b.lineEnd=b.point=m,Y.add(Yt(G)),G=new _},result:function(){var t=Y/2;return Y=new _,t}};function Wt(){b.point=Gt}function Gt(t,n){b.point=ht,lt=z=t,ft=K=n}function ht(t,n){G.add(K*t-z*n),z=t,K=n}function zt(){ht(lt,ft)}var M=1/0,C=M,P=-M,L=P,nt={point:Kt,lineStart:m,lineEnd:m,polygonStart:m,polygonEnd:m,result:function(){var t=[[M,C],[P,L]];return P=L=-(C=M=1/0),t}};function Kt(t,n){t<M&&(M=t),t>P&&(P=t),n<C&&(C=n),n>L&&(L=n)}var X=0,Z=0,N=0,x=0,I=0,S=0,B=0,D=0,k=0,dt,pt,v,y,g={point:w,lineStart:et,lineEnd:rt,polygonStart:function(){g.lineStart=Bt,g.lineEnd=Dt},polygonEnd:function(){g.point=w,g.lineStart=et,g.lineEnd=rt},result:function(){var t=k?[B/k,D/k]:S?[x/S,I/S]:N?[X/N,Z/N]:[NaN,NaN];return X=Z=N=x=I=S=B=D=k=0,t}};function w(t,n){X+=t,Z+=n,++N}function et(){g.point=Xt}function Xt(t,n){g.point=Zt,w(v=t,y=n)}function Zt(t,n){var i=t-v,e=n-y,r=U(i*i+e*e);x+=r*(v+t)/2,I+=r*(y+n)/2,S+=r,w(v=t,y=n)}function rt(){g.point=w}function Bt(){g.point=qt}function Dt(){gt(dt,pt)}function qt(t,n){g.point=gt,w(dt=v=t,pt=y=n)}function gt(t,n){var i=t-v,e=n-y,r=U(i*i+e*e);x+=r*(v+t)/2,I+=r*(y+n)/2,S+=r,r=y*t-v*n,B+=r*(v+t),D+=r*(y+n),k+=r*3,w(v=t,y=n)}function mt(t){this._context=t}mt.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(t,n){switch(this._point){case 0:{this._context.moveTo(t,n),this._point=1;break}case 1:{this._context.lineTo(t,n);break}default:{this._context.moveTo(t+this._radius,n),this._context.arc(t,n,this._radius,0,Ht);break}}},result:m};var q=new _,V,vt,yt,$,A,R={point:m,lineStart:function(){R.point=Ut},lineEnd:function(){V&&bt(vt,yt),R.point=m},polygonStart:function(){V=!0},polygonEnd:function(){V=null},result:function(){var t=+q;return q=new _,t}};function Ut(t,n){R.point=bt,vt=$=t,yt=A=n}function bt(t,n){$-=t,A-=n,q.add(U($*$+A*A)),$=t,A=n}let it,T,at,ot;class st{constructor(n){this._append=n==null?wt:Jt(n),this._radius=4.5,this._=""}pointRadius(n){return this._radius=+n,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(n,i){switch(this._point){case 0:{this._append`M${n},${i}`,this._point=1;break}case 1:{this._append`L${n},${i}`;break}default:{if(this._append`M${n},${i}`,this._radius!==at||this._append!==T){const e=this._radius,r=this._;this._="",this._append`m0,${e}a${e},${e} 0 1,1 0,${-2*e}a${e},${e} 0 1,1 0,${2*e}z`,at=e,T=this._append,ot=this._,this._=r}this._+=ot;break}}}result(){const n=this._;return this._="",n.length?n:null}}function wt(t){let n=1;this._+=t[0];for(const i=t.length;n<i;++n)this._+=arguments[n]+t[n]}function Jt(t){const n=Math.floor(t);if(!(n>=0))throw new RangeError(`invalid digits: ${t}`);if(n>15)return wt;if(n!==it){const i=10**n;it=n,T=function(r){let s=1;this._+=r[0];for(const c=r.length;s<c;++s)this._+=Math.round(arguments[s]*i)/i+r[s]}}return T}function jt(t,n){let i=3,e=4.5,r,s;function c(u){return u&&(typeof e=="function"&&s.pointRadius(+e.apply(this,arguments)),E(u,r(s))),s.result()}return c.area=function(u){return E(u,r(b)),b.result()},c.measure=function(u){return E(u,r(R)),R.result()},c.bounds=function(u){return E(u,r(nt)),nt.result()},c.centroid=function(u){return E(u,r(g)),g.result()},c.projection=function(u){return arguments.length?(r=u==null?(t=null,Vt):(t=u).stream,c):t},c.context=function(u){return arguments.length?(s=u==null?(n=null,new st(i)):new mt(n=u),typeof e!="function"&&s.pointRadius(e),c):n},c.pointRadius=function(u){return arguments.length?(e=typeof u=="function"?u:(s.pointRadius(+u),+u),c):e},c.digits=function(u){if(!arguments.length)return i;if(u==null)i=null;else{const d=Math.floor(u);if(!(d>=0))throw new RangeError(`invalid digits: ${u}`);i=d}return n===null&&(s=new st(i)),c},c.projection(t).digits(i).context(n)}function St(){var t=0,n=1,i=1,e=[.5],r=[0,1],s;function c(d){return d!=null&&d<=d?r[Ct(e,d,0,i)]:s}function u(){var d=-1;for(e=new Array(i);++d<i;)e[d]=((d+1)*n-(d-i)*t)/(i+1);return c}return c.domain=function(d){return arguments.length?([t,n]=d,t=+t,n=+n,u()):[t,n]},c.range=function(d){return arguments.length?(i=(r=Array.from(d)).length-1,u()):r.slice()},c.invertExtent=function(d){var l=r.indexOf(d);return l<0?[NaN,NaN]:l<1?[t,e[0]]:l>=i?[e[i-1],n]:[e[l-1],e[l]]},c.unknown=function(d){return arguments.length&&(s=d),c},c.thresholds=function(){return e.slice()},c.copy=function(){return St().domain([t,n]).range(r).unknown(s)},At.apply(Ot(c),arguments)}var _t=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(It);Tt(_t);function Qt(t){return t}function tn(t){if(t==null)return Qt;var n,i,e=t.scale[0],r=t.scale[1],s=t.translate[0],c=t.translate[1];return function(u,d){d||(n=i=0);var l=2,o=u.length,a=new Array(o);for(a[0]=(n+=u[0])*e+s,a[1]=(i+=u[1])*r+c;l<o;)a[l]=u[l],++l;return a}}function nn(t,n){for(var i,e=t.length,r=e-n;r<--e;)i=t[r],t[r++]=t[e],t[e]=i}function en(t,n){return typeof n=="string"&&(n=t.objects[n]),n.type==="GeometryCollection"?{type:"FeatureCollection",features:n.geometries.map(function(i){return ct(t,i)})}:ct(t,n)}function ct(t,n){var i=n.id,e=n.bbox,r=n.properties==null?{}:n.properties,s=Mt(t,n);return i==null&&e==null?{type:"Feature",properties:r,geometry:s}:e==null?{type:"Feature",id:i,properties:r,geometry:s}:{type:"Feature",id:i,bbox:e,properties:r,geometry:s}}function Mt(t,n){var i=tn(t.transform),e=t.arcs;function r(o,a){a.length&&a.pop();for(var f=e[o<0?~o:o],h=0,p=f.length;h<p;++h)a.push(i(f[h],h));o<0&&nn(a,p)}function s(o){return i(o)}function c(o){for(var a=[],f=0,h=o.length;f<h;++f)r(o[f],a);return a.length<2&&a.push(a[0]),a}function u(o){for(var a=c(o);a.length<4;)a.push(a[0]);return a}function d(o){return o.map(u)}function l(o){var a=o.type,f;switch(a){case"GeometryCollection":return{type:a,geometries:o.geometries.map(l)};case"Point":f=s(o.coordinates);break;case"MultiPoint":f=o.coordinates.map(s);break;case"LineString":f=c(o.arcs);break;case"MultiLineString":f=o.arcs.map(c);break;case"Polygon":f=d(o.arcs);break;case"MultiPolygon":f=o.arcs.map(d);break;default:return null}return{type:a,coordinates:f}}return l(n)}function rn(t,n){var i={},e={},r={},s=[],c=-1;n.forEach(function(l,o){var a=t.arcs[l<0?~l:l],f;a.length<3&&!a[1][0]&&!a[1][1]&&(f=n[++c],n[c]=l,n[o]=f)}),n.forEach(function(l){var o=u(l),a=o[0],f=o[1],h,p;if(h=r[a])if(delete r[h.end],h.push(l),h.end=f,p=e[f]){delete e[p.start];var F=p===h?h:h.concat(p);e[F.start=h.start]=r[F.end=p.end]=F}else e[h.start]=r[h.end]=h;else if(h=e[f])if(delete e[h.start],h.unshift(l),h.start=a,p=r[a]){delete r[p.end];var H=p===h?h:p.concat(h);e[H.start=p.start]=r[H.end=h.end]=H}else e[h.start]=r[h.end]=h;else h=[l],e[h.start=a]=r[h.end=f]=h});function u(l){var o=t.arcs[l<0?~l:l],a=o[0],f;return t.transform?(f=[0,0],o.forEach(function(h){f[0]+=h[0],f[1]+=h[1]})):f=o[o.length-1],l<0?[f,a]:[a,f]}function d(l,o){for(var a in l){var f=l[a];delete o[f.start],delete f.start,delete f.end,f.forEach(function(h){i[h<0?~h:h]=1}),s.push(f)}}return d(r,e),d(e,r),n.forEach(function(l){i[l<0?~l:l]||s.push([l])}),s}function an(t){return Mt(t,on.apply(this,arguments))}function on(t,n,i){var e,r,s;if(arguments.length>1)e=sn(t,n,i);else for(r=0,e=new Array(s=t.arcs.length);r<s;++r)e[r]=r;return{type:"MultiLineString",arcs:rn(t,e)}}function sn(t,n,i){var e=[],r=[],s;function c(a){var f=a<0?~a:a;(r[f]||(r[f]=[])).push({i:a,g:s})}function u(a){a.forEach(c)}function d(a){a.forEach(u)}function l(a){a.forEach(d)}function o(a){switch(s=a,a.type){case"GeometryCollection":a.geometries.forEach(o);break;case"LineString":u(a.arcs);break;case"MultiLineString":case"Polygon":d(a.arcs);break;case"MultiPolygon":l(a.arcs);break}}return o(n),r.forEach(i==null?function(a){e.push(a[0].i)}:function(a){i(a[0].g,a[a.length-1].g)&&e.push(a[0].i)}),e}const cn={AL:"Alabama",AK:"Alaska",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",FL:"Florida",GA:"Georgia",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PA:"Pennsylvania",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"},un=(t,n,i)=>{const r=t.clientY,{bachelorsOrHigher:s=0,area_name:c="",state:u=""}=i.get(Number(n.id))??{};$t({e:t,posY:r,width:13}),ut("#tooltip").html(`
      <strong class='fw-medium'>
        ${c.toString()}
        <br>
        ${cn[u]}
      </strong>
      - ${s.toString()}%
    `)},ln=(t,n,i,e)=>{const d=t.append("g").attr("transform","translate(560,30)"),l=Lt().domain([i,e]).range([0,300]),o=[i,...n.thresholds(),e];d.selectAll("rect").data(n.range().map(a=>n.invertExtent(a))).enter().append("rect").attr("x",a=>l(a[0])).attr("y",0).attr("width",a=>l(a[1])-l(a[0])).attr("height",15).attr("fill",a=>n(a[0])),d.append("g").call(xt(l).tickSize(25).tickValues(o).tickFormat(a=>`${Math.round(+a).toString()}%`)).select(".domain").remove()},fn=(t,n)=>{const i=Pt(n.map(o=>o.bachelorsOrHigher))??0,e=Rt(n.map(o=>o.bachelorsOrHigher))??0,r=St([i,e],_t[9]),s=en(t,t.objects.counties),c=new Map(n.map(o=>[o.fips,{fips:o.fips,bachelorsOrHigher:o.bachelorsOrHigher,area_name:o.area_name,state:o.state}])),u="features"in s?s.features:[],d=jt(),l=ut("#choropleth-map").append("svg").attr("viewBox","0 0 900 600");l.append("g").selectAll("path").data(u).enter().append("path").attr("fill",o=>{var a;return r(Number((a=c.get(Number(o.id)))==null?void 0:a.bachelorsOrHigher))}).attr("d",d).on("mouseover",(o,a)=>{un(o,a,c)}).on("mouseout",(o,a)=>{var f;Nt(o,r(Number((f=c.get(Number(a.id)))==null?void 0:f.bachelorsOrHigher)))}),l.append("path").datum(an(t,t.objects.states,(o,a)=>o!==a)).attr("fill","none").attr("stroke",kt.COLORS.white).attr("stroke-width",2).attr("stroke-linejoin","round").attr("d",d),ln(l,r,i,e)},bn=()=>(Promise.all([J("topology"),J("education")]).then(([t,n])=>{fn(t,n)}).catch(t=>{t instanceof Error&&console.error(t)}),Et(3,"choropleth-map"));export{bn as ChoroplethMap};
